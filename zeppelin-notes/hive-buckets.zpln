{"paragraphs":[{"title":"Bucketing in Hive","text":"%md\n\n## Advantage :\n1. The concept of bucketing is based on the hashing technique.\n2. Here, modules of current column value and the number of required buckets is calculated (let say, F(x) % 3).\n3. Now, based on the resulted value, the data is stored into the corresponding bucket.\n4. On a larger table, creating a bucketing gives you 2-3x better query performance than a non-bucket table.\n5. Hive Bucketing overcomes creating too many directories by specifying the number of buckets you wanted to create (you are in control).","user":"anonymous","dateUpdated":"2021-12-12T15:16:42+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"title":true,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Advantage :</h2>\n<ol>\n<li>The concept of bucketing is based on the hashing technique.</li>\n<li>Here, modules of current column value and the number of required buckets is calculated (let say, F(x) % 3).</li>\n<li>Now, based on the resulted value, the data is stored into the corresponding bucket.</li>\n<li>On a larger table, creating a bucketing gives you 2-3x better query performance than a non-bucket table.</li>\n<li>Hive Bucketing overcomes creating too many directories by specifying the number of buckets you wanted to create (you are in control).</li>\n</ol>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639296085741_398019413","id":"paragraph_1639296085741_398019413","dateCreated":"2021-12-12T13:31:25+0530","dateStarted":"2021-12-12T15:16:42+0530","dateFinished":"2021-12-12T15:16:42+0530","status":"FINISHED","focus":false},{"text":"%hive\n\n-- Enable the bucketing by using the following command: -\n-- This property is not needed if you are using Hive 2.x or later\n\nset hive.enforce.bucketing = true;  ","user":"anonymous","dateUpdated":"2021-12-12T13:37:08+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639296125624_2064451048","id":"paragraph_1639296125624_2064451048","dateCreated":"2021-12-12T13:32:05+0530","dateStarted":"2021-12-12T13:34:50+0530","dateFinished":"2021-12-12T13:34:50+0530","status":"FINISHED"},{"text":"%hive\n\nCREATE TABLE IF NOT EXISTS zipcodes_temp(\nRecordNumber int,\nCountry string,\nCity string,\nZipcode int,\nstate string)\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ',';","user":"anonymous","dateUpdated":"2021-12-12T15:09:25+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639301878715_2101183113","id":"paragraph_1639301878715_2101183113","dateCreated":"2021-12-12T15:07:58+0530","dateStarted":"2021-12-12T15:09:25+0530","dateFinished":"2021-12-12T15:09:25+0530","status":"FINISHED"},{"text":"%hive\n\nLOAD DATA INPATH '/data/zipcodes20.csv' INTO TABLE zipcodes_temp;","user":"anonymous","dateUpdated":"2021-12-12T15:09:52+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639301969458_574966835","id":"paragraph_1639301969458_574966835","dateCreated":"2021-12-12T15:09:29+0530","dateStarted":"2021-12-12T15:09:52+0530","dateFinished":"2021-12-12T15:09:52+0530","status":"FINISHED"},{"text":"%hive\n\n\n\nCREATE TABLE zipcodes (\nRecordNumber int,\nCountry string,\nCity string,\nZipcode int)\nPARTITIONED BY(state string)\nCLUSTERED BY (Zipcode) INTO 32 BUCKETS\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ',';","user":"anonymous","dateUpdated":"2021-12-12T15:08:03+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. AlreadyExistsException(message:Table zipcodes already exists)"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639296290967_2066318887","id":"paragraph_1639296290967_2066318887","dateCreated":"2021-12-12T13:34:50+0530","dateStarted":"2021-12-12T14:54:58+0530","dateFinished":"2021-12-12T14:54:59+0530","status":"ERROR"},{"text":"%hive\n\nINSERT INTO zipcodes\npartition(State)  \nselect RecordNumber, Country, City, Zipcode, State  \nfrom zipcodes_temp;   ","user":"anonymous","dateUpdated":"2021-12-12T15:11:18+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"INFO  : Compiling command(queryId=hive_20211212151118_aee3c869-68cc-481a-99bc-c56d3b57df6b): \n\nINSERT INTO zipcodes\npartition(State)  \nselect RecordNumber, Country, City, Zipcode, State  \nfrom zipcodes_temp\nINFO  : Semantic Analysis Completed\nINFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:recordnumber, type:int, comment:null), FieldSchema(name:country, type:string, comment:null), FieldSchema(name:city, type:string, comment:null), FieldSchema(name:zipcode, type:int, comment:null), FieldSchema(name:state, type:string, comment:null)], properties:null)\nINFO  : Completed compiling command(queryId=hive_20211212151118_aee3c869-68cc-481a-99bc-c56d3b57df6b); Time taken: 0.173 seconds\nINFO  : Executing command(queryId=hive_20211212151118_aee3c869-68cc-481a-99bc-c56d3b57df6b): \n\nINSERT INTO zipcodes\npartition(State)  \nselect RecordNumber, Country, City, Zipcode, State  \nfrom zipcodes_temp\nWARN  : \nINFO  : Query ID = hive_20211212151118_aee3c869-68cc-481a-99bc-c56d3b57df6b\nINFO  : Total jobs = 1\nINFO  : Launching Job 1 out of 1\nINFO  : Starting task [Stage-1:MAPRED] in serial mode\nINFO  : Number of reduce tasks determined at compile time: 32\nINFO  : In order to change the average load for a reducer (in bytes):\nINFO  :   set hive.exec.reducers.bytes.per.reducer=<number>\nINFO  : In order to limit the maximum number of reducers:\nINFO  :   set hive.exec.reducers.max=<number>\nINFO  : In order to set a constant number of reducers:\nINFO  :   set mapreduce.job.reduces=<number>\nINFO  : number of splits:1\nINFO  : Submitting tokens for job: job_1639276645913_0002\nINFO  : Executing with tokens: []\nINFO  : The url to track the job: http://quickstart-bigdata:8088/proxy/application_1639276645913_0002/\nINFO  : Starting Job = job_1639276645913_0002, Tracking URL = http://quickstart-bigdata:8088/proxy/application_1639276645913_0002/\nINFO  : Kill Command = /opt/cloudera/parcels/CDH-6.3.2-1.cdh6.3.2.p0.1605554/lib/hadoop/bin/hadoop job  -kill job_1639276645913_0002\nINFO  : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 32\nINFO  : 2021-12-12 15:11:27,021 Stage-1 map = 0%,  reduce = 0%\nINFO  : 2021-12-12 15:11:33,212 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.44 sec\nINFO  : 2021-12-12 15:11:40,488 Stage-1 map = 100%,  reduce = 6%, Cumulative CPU 9.03 sec\nINFO  : 2021-12-12 15:11:41,527 Stage-1 map = 100%,  reduce = 9%, Cumulative CPU 11.15 sec\nINFO  : 2021-12-12 15:11:46,695 Stage-1 map = 100%,  reduce = 19%, Cumulative CPU 20.4 sec\nINFO  : 2021-12-12 15:11:51,940 Stage-1 map = 100%,  reduce = 22%, Cumulative CPU 23.49 sec\nINFO  : 2021-12-12 15:11:52,961 Stage-1 map = 100%,  reduce = 28%, Cumulative CPU 29.66 sec\nINFO  : 2021-12-12 15:11:58,168 Stage-1 map = 100%,  reduce = 34%, Cumulative CPU 35.71 sec\nINFO  : 2021-12-12 15:11:59,198 Stage-1 map = 100%,  reduce = 38%, Cumulative CPU 39.86 sec\nINFO  : 2021-12-12 15:12:02,323 Stage-1 map = 100%,  reduce = 41%, Cumulative CPU 42.6 sec\nINFO  : 2021-12-12 15:12:04,438 Stage-1 map = 100%,  reduce = 44%, Cumulative CPU 45.64 sec\nINFO  : 2021-12-12 15:12:05,465 Stage-1 map = 100%,  reduce = 47%, Cumulative CPU 49.76 sec\nINFO  : 2021-12-12 15:12:08,548 Stage-1 map = 100%,  reduce = 50%, Cumulative CPU 53.24 sec\nINFO  : 2021-12-12 15:12:10,584 Stage-1 map = 100%,  reduce = 56%, Cumulative CPU 58.02 sec\nINFO  : 2021-12-12 15:12:13,667 Stage-1 map = 100%,  reduce = 59%, Cumulative CPU 60.84 sec\nINFO  : 2021-12-12 15:12:15,715 Stage-1 map = 100%,  reduce = 63%, Cumulative CPU 64.25 sec\nINFO  : 2021-12-12 15:12:16,743 Stage-1 map = 100%,  reduce = 66%, Cumulative CPU 66.97 sec\nINFO  : 2021-12-12 15:12:18,875 Stage-1 map = 100%,  reduce = 69%, Cumulative CPU 69.34 sec\nINFO  : 2021-12-12 15:12:20,944 Stage-1 map = 100%,  reduce = 72%, Cumulative CPU 71.81 sec\nINFO  : 2021-12-12 15:12:21,991 Stage-1 map = 100%,  reduce = 75%, Cumulative CPU 75.68 sec\nINFO  : 2021-12-12 15:12:25,203 Stage-1 map = 100%,  reduce = 78%, Cumulative CPU 78.46 sec\nINFO  : 2021-12-12 15:12:26,239 Stage-1 map = 100%,  reduce = 81%, Cumulative CPU 82.5 sec\nINFO  : 2021-12-12 15:12:28,305 Stage-1 map = 100%,  reduce = 84%, Cumulative CPU 86.38 sec\nINFO  : 2021-12-12 15:12:29,337 Stage-1 map = 100%,  reduce = 88%, Cumulative CPU 88.65 sec\nINFO  : 2021-12-12 15:12:31,423 Stage-1 map = 100%,  reduce = 91%, Cumulative CPU 91.46 sec\nINFO  : 2021-12-12 15:12:33,505 Stage-1 map = 100%,  reduce = 94%, Cumulative CPU 93.82 sec\nINFO  : 2021-12-12 15:12:35,548 Stage-1 map = 100%,  reduce = 97%, Cumulative CPU 96.88 sec\nINFO  : 2021-12-12 15:12:36,568 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 98.67 sec\nINFO  : MapReduce Total cumulative CPU time: 1 minutes 38 seconds 670 msec\nINFO  : Ended Job = job_1639276645913_0002\nINFO  : Starting task [Stage-0:MOVE] in serial mode\nINFO  : Loading data to table default.zipcodes partition (state=null) from hdfs://quickstart-bigdata:8020/user/hive/warehouse/zipcodes/.hive-staging_hive_2021-12-12_15-11-18_339_7757250045408563305-1/-ext-10000\nINFO  : \n\nINFO  : \t Time taken to load dynamic partitions: 0.278 seconds\nINFO  : \t Time taken for adding to write entity : 0.001 seconds\nINFO  : Starting task\n"},{"type":"TEXT","data":"Query executed successfully. Affected rows :  [Stage-2:STATS] in serial mode\nINFO  : MapReduce Jobs Launched: \nINFO  : Stage-Stage-1: Map: 1  Reduce: 32   Cumulative CPU: 98.67 s2ec   HDFS R0\nead: 154348 HDFS Write: 1818 HDFS EC Read: 0 SUCCESS\nINFO  : Total MapReduce CPU Time Spent: 1 minutes 38 seconds 670 msec\nINFO  : Completed executing command(queryId=hive_20211212151118_aee3c869-68cc-481a-99bc-c56d3b57df6b); Time taken: 80.097 seconds\nINFO  : OK\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"HIVE JOB","tooltip":"View in YARN WEB UI","group":"jdbc","values":[{"jobUrl":"http://quickstart-bigdata:8088/proxy/application_1639276645913_0002/"}],"interpreterSettingId":"hive"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639301092472_1781330536","id":"paragraph_1639301092472_1781330536","dateCreated":"2021-12-12T14:54:52+0530","dateStarted":"2021-12-12T15:11:18+0530","dateFinished":"2021-12-12T15:12:38+0530","status":"FINISHED"},{"text":"%hive\n\nSELECT * FROM zipcodes WHERE state='PR' and zipcode=704;","user":"anonymous","dateUpdated":"2021-12-12T15:14:47+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"INFO  : Compiling command(queryId=hive_20211212151447_32254cd1-e180-4a4c-a461-1cde71b87bc0): \n\nSELECT * FROM zipcodes WHERE state='PR' and zipcode=704\nINFO  : Semantic Analysis Completed\nINFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:zipcodes.recordnumber, type:int, comment:null), FieldSchema(name:zipcodes.country, type:string, comment:null), FieldSchema(name:zipcodes.city, type:string, comment:null), FieldSchema(name:zipcodes.zipcode, type:int, comment:null), FieldSchema(name:zipcodes.state, type:string, comment:null)], properties:null)\nINFO  : Completed compiling command(queryId=hive_20211212151447_32254cd1-e180-4a4c-a461-1cde71b87bc0); Time taken: 0.164 seconds\nINFO  : Executing command(queryId=hive_20211212151447_32254cd1-e180-4a4c-a461-1cde71b87bc0): \n\nSELECT * FROM zipcodes WHERE state='PR' and zipcode=704\nWARN  : \nINFO  : Query ID = hive_20211212151447_32254cd1-e180-4a4c-a461-1cde71b87bc0\nINFO  : Total jobs = 1\nINFO  : Launching Job 1 out of 1\nINFO  : Starting task [Stage-1:MAPRED] in serial mode\nINFO  : Number of reduce tasks is set to 0 since there's no reduce operator\nINFO  : number of splits:1\nINFO  : Submitting tokens for job: job_1639276645913_0003\nINFO  : Executing with tokens: []\nINFO  : The url to track the job: http://quickstart-bigdata:8088/proxy/application_1639276645913_0003/\nINFO  : Starting Job = job_1639276645913_0003, Tracking URL = http://quickstart-bigdata:8088/proxy/application_1639276645913_0003/\nINFO  : Kill Command = /opt/cloudera/parcels/CDH-6.3.2-1.cdh6.3.2.p0.1605554/lib/hadoop/bin/hadoop job  -kill job_1639276645913_0003\nINFO  : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0\nINFO  : 2021-12-12 15:14:53,532 Stage-1 map = 0%,  reduce = 0%\nINFO  : 2021-12-12 15:14:58,669 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.63 sec\nINFO  : MapReduce Total cumulative CPU time: 2 seconds 630 msec\nINFO  : Ended Job = job_1639276645913_0003\nINFO  : MapReduce Jobs Launched: \nINFO  : Stage-Stage-1: Map: 1   Cumulative CPU: 2.63 sec   HDFS Read: 5704 HDFS Write: 245 HDFS EC Read: 0 SUCCESS\nINFO  : Total MapReduce CPU Time Spent: 2 seconds 630 msec\nINFO  : Completed executing command(queryId=hive_20211212151447_32254cd1-e180-4a4c-a461-1cde71b87bc0); Time taken: 12.06 seconds\nINFO  : OK\n"},{"type":"TABLE","data":"recordnumber\tcountry\tcity\tzipcode\tstate\n3\tUS\tSECT LANAUSSE\t704\tPR\n2\tUS\tPASEO COSTA DEL SUR\t704\tPR\n4\tUS\tURB EUGENE RICE\t704\tPR\n1\tUS\tPARC PARQUE\t704\tPR\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"HIVE JOB","tooltip":"View in YARN WEB UI","group":"jdbc","values":[{"jobUrl":"http://quickstart-bigdata:8088/proxy/application_1639276645913_0003/"}],"interpreterSettingId":"hive"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639301190320_717614809","id":"paragraph_1639301190320_717614809","dateCreated":"2021-12-12T14:56:30+0530","dateStarted":"2021-12-12T15:14:47+0530","dateFinished":"2021-12-12T15:14:59+0530","status":"FINISHED"},{"text":"%hive\n","user":"anonymous","dateUpdated":"2021-12-12T15:14:47+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639302287464_1424409880","id":"paragraph_1639302287464_1424409880","dateCreated":"2021-12-12T15:14:47+0530","status":"READY"}],"name":"hive-buckets","id":"2GR8HW4Z6","defaultInterpreterGroup":"spark","version":"0.10.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/hive-buckets"}